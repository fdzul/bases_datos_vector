---
title: "Bases de datos del Vector del Dengue (Huevos y Adultos)"
subtitle: Felipe Antonio Dzul Manzanilla | CVU 6172953
format: 
  html:
      theme: flatly
      code-fold: true
      toc: true
      number-sections: true
title-block-banner: true
editor: visual
execute:
  freeze: auto
---

## Introdución

El programa de prevención y control del dengue implementó desde el 2010 un sistema de vigilancia entomológica basado en la instalación de ovitrampas en al menos una localidad de cada estado, estos dispositivos son empleados en un muestreo sistemático carácterizado por instalar cuatro ovitrampas por manzana (una ovitrampa por cada lado de la manzana) con un intervalo de separación de cada 4 a 6 manzanas en zonas planas y con un intervalo de separación de 2 a 3 manzanas en zonas con relieve (Figura 1). Las ovitrampas se instalan en el exterior del domicilio en lugares sombreados a una altura de 1.5 metros.

```{r figura1,fig.cap= "Figura 1. Ilustración del muestreo de la vigilancia entomológica con ovitrampas en México."}
#| warning: False
#| message: False
#| echo: true
#| output: true
#| out.width: "100%"
path <- "/Users/felipedzul/Dropbox/CENAPRECE/2024/31_yucatan/DescargaOvitrampasMesFco.txt"
deneggs::blocks_surveillance(locality = "Ticul",
                             cve_edo = "31",
                             path_coords = path)
```

Las ovitrampas utilizadas en México consisten en recipientes de plástico negro con una capacidad de un litro cubierto en su superficie interior con papel pellon (F-1600), a la cual se le incorpora agua potable hasta antes de 2 cm de su borde superior (Figura 2). Semanalmente, se le retira el sustrato de ovoposición a las ovitrampas y se les cambia por un sustrato nuevo y agua. El número de huevos en la papeleta de cada ovitrampa instalada es contado y registrado. La información asociada a la papeleta (localidad, municipio, manzana, sector, fecha, colector y número de huevos) es capturado en el Módulo de Vigilancia Entomológica y Control Integral del Vector del Sistema de Monitoreo Integral de Vectores de la Secretaría de Salud Federal (http://geosis.mx/aplicaciones/sismv/). La descripción de los procesos puede encontrarse en la guía metodológica para la vigilancia entomológica con ovitrampas 12.

```{=html}
<style>
.grid-container {
  display: grid;
  gap: 0px;
  background-color: #FFFFFF;
  padding: 1px;
}

.grid-item1 {
  background-color: rgba(255, 255, 255);
  text-align: center;
  padding: 0px;
  font-size: 1px;
}


.grid-item2 {
  grid-column: 1 / span 3;
  grid-row: 3;
}
</style>
```
</head>

<body>

::: grid-container
::: grid-item1
![](https://github.com/fdzul/deneggs/blob/master/IMG_6137.JPG?raw=true){width="98%"}
:::

::: grid-item1
![](https://github.com/fdzul/deneggs/blob/master/IMG_6176.JPG?raw=true){width="98%"}
:::

::: grid-item1
![](https://github.com/fdzul/deneggs/blob/master/IMG_6186.JPG?raw=true){width="98%"}
:::

::: grid-item2
![](https://github.com/fdzul/deneggs/blob/master/IMG_6150.JPG?raw=true){width="98%"}
:::
:::

<figcaption>Figura 2. Ovitrampa y sustrato de ovoposición</figcaption>

</body>

</html>

En relación con la vigilancia entomovirológica, la colecta de adultos en reposo permite la detección temprana de virus en mosquitos y podría facilitar acciones tempranas y específicas de control de vectores, si se implementa y utiliza de manera oportuna. La vigilancia entomológica en la Secretaría de Salud inicio desde el 2009, cuando el InDRE (Instituto de Diagnóstico y Referencia Epidemiológicos Dr. Manuel Martínez Báez) planteó un proyecto de investigación en Morelos, Guadalajara y Guerrero. Posteriormente, con la introdución de chikungunya y Zika en México, estados como Guerrero implementaron la Vigilancia Entomovirológica en la Ciudad de Acapulco. Los resultados permitieron detectar la circulación del virus de chikungunya en Aedes aegypti con antelación a los primeros casos en humanos. El análisis retrospectivo de las muestras de RNA permitió comprobar que los virus del dengue, chikungunya y Zika circularon en mosquitos al mismo tiempo15, 16. Durante dos años consecutivos (febrero 2017 a noviembre 2018) la vigilancia entomovirológica se realizó en 18 estados de la republica mexicana (Baja California Norte, Campeche, Chiapas, Chihuahua, Durango, Estado de México, Guerrero, Hidalgo, Jalisco, México City, Oaxaca, Puebla, Tabasco, Tamaulipas, Veracruz and Yucatán)17. Actualmente la vigilancia entomovirológica se lleva a cabo en cuatro localidades de México: Acapulco en el estado de Guerrero, Jojutla en el estado de Morelos, Tapachula en el estado de Chiapas y en el Puerto de Veracruz y Boca del Río en el estado de Veracruz 18.

## Objetivo

Describir brevemente las bases de datos del vector del dengue.

## Material y Métodos

## Resultados

El sistema de vigilancia entomológica con ovitrampas opera en todo el país y todos los estados han instalado la vigilancia entomológica con ovitrampas en al menos una localidad, excepto el estado de tlaxcala (Figura 3, Figura 4). 


```{r echo=FALSE, fig.cap= "Numero de estado, muninicipios y localidades con ovitrampas en México"}
# Step 1.1 load ovitraps (2012-2019)
load("~/Library/CloudStorage/OneDrive-Personal/automatic_read_ovitraps/8.RData/ovitraps/ovitraps_2012_2019_for_encript.RData")

# Step 1.2 load ovitraps (2021-2024)
load("~/Library/CloudStorage/OneDrive-Personal/automatic_read_ovitraps/8.RData/ovitraps/ovitraps_2021_2024_for_encript.RData")


y  <- y |>
    dplyr::mutate(year = lubridate::year(date)) |>
    dplyr::mutate(cve_edo = stringr::str_sub(clave,
                                             start = 1,
                                             end = 2),
                  cve_mpo = stringr::str_sub(clave,
                                             start = 1,
                                             end = 5),
                  cve_loc = stringr::str_sub(clave,
                                             start = 1,
                                             end = 9)) |>
    dplyr::group_by(year) |>
    dplyr::summarise(edo = length(unique(cve_edo)),
                     mun = length(unique(cve_mpo)),
                     loc = length(unique(cve_loc)))

x  <- x |>
    dplyr::mutate(year = lubridate::year(date)) |>
    dplyr::mutate(cve_edo = stringr::str_sub(clave,
                                             start = 1,
                                             end = 2),
                  cve_mpo = stringr::str_sub(clave,
                                             start = 1,
                                             end = 5),
                  cve_loc = stringr::str_sub(clave,
                                             start = 1,
                                             end = 9)) |>
    dplyr::group_by(year) |>
    dplyr::summarise(edo = length(unique(cve_edo)),
                     mun = length(unique(cve_mpo)),
                     loc = length(unique(cve_loc)))

xy <- dplyr::bind_rows(x, y) |>
    dplyr::filter(!is.na(year)) |>
    dplyr::rename(Estados = edo,
                  Municipios =mun,
                  Localidades = loc) |>
    tidyr::pivot_longer(cols = -year) |>
  dplyr::mutate(name = factor(name,
                                levels = c("Estados", "Localidades", "Municipios")[c(1, 3,2)]))




ggplot2::ggplot(data = xy) +
    ggplot2::geom_col(ggplot2::aes(y = value,
                                   x = year,
                                   fill = year)) +
    ggplot2::facet_grid("name",
                        scales = "free_y") +
    ggplot2::theme(legend.position = "none") +
    ggplot2::scale_fill_viridis_c() +
    ggplot2::xlab("Años") +
    ggplot2::ylab("Número")  +
    ggplot2::scale_x_continuous(breaks = seq(from = 2011,
                                             to = 2025,
                                             by = 2))
```


```{r, echo=FALSE, fig.cap= "Distribución de localidaes con ovitrampas en el 2024"}
# Step 1. load ovitraps (2021-2024)
load("~/Library/CloudStorage/OneDrive-Personal/automatic_read_ovitraps/8.RData/ovitraps/ovitraps_2021_2024_for_encript.RData")

x  <- x |>
    dplyr::mutate(year = lubridate::year(date)) |>
    dplyr::filter(year == 2024) |>
    dplyr::mutate(cve_edo = stringr::str_sub(clave,
                                             start = 1,
                                             end = 2),
                  cve_mpo = stringr::str_sub(clave,
                                             start = 1,
                                             end = 5),
                  cve_loc = stringr::str_sub(clave,
                                             start = 1,
                                             end = 9)) |>
    dplyr::group_by(cve_edo, cve_mpo, cve_loc) |>
    dplyr::summarise(ovitraps = length(unique(ovitrap)), 
                     .groups = "drop")


# Step 2. load the iter loc ####
load("~/Library/CloudStorage/OneDrive-Personal/automatic_read_iter/8.RData/iter_2020_loc.RData")
iter_2020_loc <- iter_2020_loc |>
        dplyr::select(entidad, nom_ent,  mun,
                      nom_mun, loc,  nom_loc,
                      longitud, latitud, altitud,
                      pobtot) |>
    dplyr::mutate(cve_loc = paste(entidad, mun, loc, sep = "")) |>
    dplyr::select(-entidad, -mun, -loc)

# Step 3. left joint ####
loc_ovitraps_coordinates <- dplyr::left_join(x = x,
                                             y = iter_2020_loc,
                                             by = "cve_loc") |>
    dplyr::filter(!is.na(longitud)) |>
    sf::st_as_sf(coords = c("longitud", "latitud"),
                 crs = 4326)

mapview::mapview(loc_ovitraps_coordinates,
                 zcol = "ovitraps",
                 layer.name = "Ovitrampas")

```












Por ejemplo, en el estado de Veracruz, el sistema esta instalado en 15 localidades: Panuco, Tuxpan, Papantla, Poza Rica, Martínez de la Torre, Xalapa, Córdoba, Orizaba, Veracruz, Alvarado, Bocal del Río, Cosamaloapan, San Andrés y Coatzacoalcos.

Entre 2012 y 2019, 
se han analizado más de 72 millones de registros de ovitrampas (72,304,515).
